{"code":"!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=1)}([function(e,t){throw new Error(\"Module parse failed: Identifier 'web3' has already been declared (3:4)\\nYou may need an appropriate loader to handle this file type.\\n| import web3 from '../../web3/dist/web3.min.js';\\r\\n| // setting up the provider\\r\\n| var web3;\\r\\n| if (typeof web3 !== 'undefined') {\\r\\n|   web3 = new Web3(web3.currentProvider);\\r\")},function(e,t,r){\"use strict\";r.r(t);var n=r(0),o=r.n(n);function a(e){var t=new Date(1e3*e),r=t.getFullYear(),n=(\"0\"+t.getMonth()).slice(-2);return(\"0\"+t.getDate()).slice(-2)+\"-\"+n+\"-\"+r+\" \"+(\"0\"+t.getHours()).slice(-2)+\":\"+(\"0\"+t.getMinutes()).slice(-2)+\":\"+(\"0\"+t.getSeconds()).slice(-2)}function s(){var e=o.a.eth.getBlock(\"latest\"),t=new Date(1e3*e.timestamp),r=t.getFullYear(),n=t.getUTCMonth()+1,a=(\"0\"+t.getUTCDate()).slice(-2),i=t.getHours(),s=\"0\"+t.getMinutes(),c=\"0\"+t.getSeconds();return r+\"-\"+n+\"-\"+a+\" \"+i+\":\"+s.substr(-2)+\":\"+c.substr(-2)}var c=[];c.push([\"Eth Address\",\"Owner\",\"Device Type\",\"Peak Power +\",\"Peak Power -\",\"Coordinates [Lat-Long]\",\"Voltage Level\",\"Location\",\"Install Date\"]),$(\"#consRegInfoButton\").click(function(){n.consumptionContract.consAccntsArr($(\"#inputConsAddr\").val(),function(e,t){e?console.log(e):$(\"#consRegInfo\").html(\" \"+t)})}),$(\"#resetConsButton\").click(function(){document.getElementById(\"inputConsAddr\").value=\"\",$(\"#consRegInfo\").html(\"\")}),consAccntList=document.getElementById(\"consAccountList\"),consAccntList.addEventListener(\"click\",function(e){if(\"LI\"==e.target.nodeName){for(document.getElementById(\"consAccntTitle\").innerHTML=e.target.innerHTML,n.consumptionContract.getConsAccntDetails(e.target.innerHTML,function(e,t){e?console.log(e):$(\"#consAccntRegDetails\").html(\"<b>Owner: </b>\"+t[0]+\"<br><b>Device Type: </b>\"+t[1]+\"<br><b>Peak Power (+): </b>\"+t[2]+\"<br><b>Location Type: </b>\"+t[3]+\"<br><b>Latitude: </b>\"+t[4]/1e4+\"<br><b>Longitude: </b>\"+t[5]/1e4+\"<br><b>Install Date: </b>\"+t[6])}),n.consumptionContract.getConsBalance(e.target.innerHTML,function(e,t){e?console.log(e):$(\"#consAccntBalance\").html(\"\"+t)}),n.consumptionContract.getConsEnerConsumption(e.target.innerHTML,function(e,t){if(e)console.error(e);else{var r=document.getElementById(\"consAccount\");r.innerHTML=\"\";var n=[];n.push([\"Eth Address\",\"Time\",\"Energy\",\"Block Number\",\"BlockHash\",\"Gas Price [wei]\"]);for(var o=0;o<t[1].length;o++)n.push([t[0],a(t[1][o].c),t[2][o].c,t[3][o].c,t[4][o],t[5][o].c]);var r=document.getElementById(\"consAccount\");r.style.cssText=\"table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;\";for(var i=n[0].length,s=r.insertRow(-1),o=0;o<i;o++){var c=document.createElement(\"TH\");c.innerHTML=n[0][o],s.appendChild(c)}for(var o=1;o<n.length;o++){s=r.insertRow(-1);for(var l=0;l<i;l++){var d=s.insertCell(-1);d.style.cssText=\"white-space: nowrap; text-overflow:ellipsis; overflow: hidden; max-width:1px;\",d.innerHTML=n[o][l]}}}}),i=0;i<e.target.parentNode.children.length;i++)e.target.parentNode.children[i].classList.remove(\"active\");e.target.classList.add(\"active\")}});var l=[],d=[],u=[],p=[];p.push([\"Eth Address\",\"Time\",\"Amount\"]);var g=L.icon({iconUrl:\"../../img/home.png\",iconSize:[30,40]}),m=L.map(\"map\").setView([48.77538056,9.35277778],14);mapLink='<a href=\"http://openstreetmap.org\">OpenStreetMap</a>',L.tileLayer(\"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",{attribution:\"&copy; \"+mapLink+\" Contributors\",maxZoom:10}).addTo(m);var h=[];h.push([\"Eth Address\",\"Owner\",\"Device Type\",\"Peak Power +\",\"Peak Power -\",\"Coordinates [Lat-Long]\",\"Voltage Level\",\"Location\",\"Install Date\"]),$(\"#proRegInfoButton\").click(function(){n.productionContract.proAccntsArr($(\"#inputProAddr\").val(),function(e,t){e?console.log(e):$(\"#proRegInfo\").html(\" \"+t)})}),$(\"#resetProButton\").click(function(){document.getElementById(\"inputProAddr\").value=\"\",$(\"#proRegInfo\").html(\"\")});var f=[],v=[],w=[],b=[];b.push([\"Eth Address\",\"Time\",\"Amount\"]),proAccntList=document.getElementById(\"proAccountList\"),proAccntList.addEventListener(\"click\",function(e){if(\"LI\"==e.target.nodeName){for(document.getElementById(\"proAccntTitle\").innerHTML=e.target.innerHTML,n.productionContract.getProAccntDetails(e.target.innerHTML,function(e,t){e?console.log(e):$(\"#proAccntRegDetails\").html(\"<b>Owner: </b>\"+t[0]+\"<br><b>Device Type: </b>\"+t[1]+\"<br><b>Peak Power (+): </b>\"+t[2]+\"<br><b>Location Type: </b>\"+t[3]+\"<br><b>Latitude: </b>\"+t[4]/1e4+\"<br><b>Longitude: </b>\"+t[5]/1e4+\"<br><b>Install Date: </b>\"+t[6])}),n.productionContract.getProBalance(e.target.innerHTML,function(e,t){e?console.log(e):$(\"#proAccntBalance\").html(\"\"+t)}),n.productionContract.getProEnerProduction(e.target.innerHTML,function(e,t){if(e)console.error(e);else{var r=document.getElementById(\"proAccount\");r.innerHTML=\"\";var n=[];n.push([\"Eth Address\",\"Time\",\"Energy\",\"Block Number\",\"BlockHash\",\"Gas Price [wei]\"]);for(var o=0;o<t[1].length;o++)n.push([t[0],a(t[1][o].c),t[2][o].c,t[3][o].c,t[4][o],t[5][o].c]);var i=document.getElementById(\"proAccount\");i.style.cssText=\"table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;\";for(var s=n[0].length,c=i.insertRow(-1),o=0;o<s;o++){var l=document.createElement(\"TH\");l.innerHTML=n[0][o],c.appendChild(l)}for(var o=1;o<n.length;o++){c=i.insertRow(-1);for(var d=0;d<s;d++){var u=c.insertCell(-1);u.style.cssText=\"white-space: nowrap; text-overflow:ellipsis; overflow: hidden; max-width:1px;\",u.innerHTML=n[o][d]}}}}),i=0;i<e.target.parentNode.children.length;i++)e.target.parentNode.children[i].classList.remove(\"active\");e.target.classList.add(\"active\")}}),window.onload=(n.productionContract.ProducerRegs({},{fromBlock:0,toBlock:\"latest\"}).get(function(e,t){if(e)console.error(e);else{for(var r=0;r<t.length;r++)h.push([t[r].args.pvAddr,t[r].args.owner,t[r].args.deviceType,t[r].args.peakPowerPos,t[r].args.peakPowerNeg,t[r].args.latitude/1e4+\" \"+t[r].args.longitude/1e4,t[r].args.voltageLevel,t[r].args.location,t[r].args.installDate]);var n=document.createElement(\"Table\");n.style.cssText=\"table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;\";var o=h[0].length,a=n.insertRow(-1);for(r=0;r<o;r++){var i=document.createElement(\"TH\");i.innerHTML=h[0][r],a.appendChild(i)}for(r=1;r<h.length;r++){a=n.insertRow(-1);for(var s=0;s<o;s++){var c=a.insertCell(-1);c.style.cssText=\"white-space: nowrap; text-overflow:ellipsis; overflow: hidden; max-width:1px;\",c.innerHTML=h[r][s]}}var l=document.getElementById(\"proRegs\");l.innerHTML=\"\",l.appendChild(n);var d=L.icon({iconUrl:\"../../img/producer.png\",iconSize:[50,50]}),u=[],p=[],f=[];for(r=0;r<t.length;r++)p.push(t[r].args.latitude/1e4),f.push(t[r].args.longitude/1e4),u.push(t[r].args.latitude/1e4+\", \"+t[r].args.longitude/1e4);var v=L.marker([48.77538056,9.16277778],{icon:g}).addTo(m);for(v.bindPopup(\"OLI Systems GmbH\"),v.on(\"mouseover\",function(e){this.openPopup()}),v.on(\"mouseout\",function(e){this.closePopup()}),r=0;r<p.length;r++){var w=f[r],b=p[r],y=\"Eth address: \"+t[r].args.pvAddr.slice(0,7)+\"...<br>Producer: \"+t[r].args.owner+\"<br>Location: \"+t[r].args.latitude/1e4+\", \"+t[r].args.longitude/1e4,T=new L.LatLng(b,w);u=new L.Marker(T,{icon:d}),m.addLayer(u),u.bindPopup(y)}}}),n.productionContract.ProducerRegs({fromBlock:\"latest\",toBlock:\"latest\"}).watch(function(e,t){e&&console.log(e)}),n.productionContract.getProAccntsList(function(e,t){if(e)console.log(e);else{t.shift();for(var r=0;r<t.length;r++)$(\"#proAccountList\").prepend(\"<li>\"+t[r]+\"</li>\")}}),n.productionContract.countProducers(function(e,t){e?console.log(e):$(\"#proCounter\").html(\" \"+t)}),n.productionContract.EnerProductionEvent({fromBlock:\"latest\",toBlock:\"latest\"}).watch(function(e,t){if(e)console.log(e);else{b.push([t.args.oliAddr,a(t.args.eTime),t.args.enerAmount]);var r=document.createElement(\"Table\");r.style.cssText=\"table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;\";for(var n=b[0].length,o=r.insertRow(-1),i=0;i<n;i++){var c=document.createElement(\"TH\");c.innerHTML=b[0][i],o.appendChild(c)}for(i=1;i<b.length;i++){o=r.insertRow(-1);for(var u=0;u<n;u++){var p=o.insertCell(-1);p.style.cssText=\"white-space: nowrap; text-overflow:ellipsis; overflow: hidden; max-width:1px;\",p.innerHTML=b[i][u]}}var g=document.getElementById(\"realTimeProdunction\");g.innerHTML=\"\",g.appendChild(r),f.push(t.args.enerAmount.c[0]),v.push(s());var m=[],h=[],y={};for(var L in v.forEach((e,t)=>y[e]=f[t]),y)y.hasOwnProperty(L);var T={},k={};T.time=L,k.energy=y[L];var P=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}(T,k);w.push(P);var x={};w.forEach(function(e){x.hasOwnProperty(e.time)?x[e.time]=x[e.time]+e.energy:x[e.time]=e.energy});var C=[];for(var A in x)C.push({time:A,energy:x[A]});for(var L in C)C.hasOwnProperty(L)&&(h.push(C[L].time),m.push(C[L].energy));function E(e){return new Date(e)}v=h,(f=m).length>10&&(f=f.slice(-10),v=v.slice(-10));var H=[{type:\"date\",mode:\"lines+markers\",name:\"Producer\",x:v.map(E),y:f,line:{color:\"#009933\"}},{type:\"scatter\",mode:\"lines+markers\",name:\"Consumer\",x:d.map(E),y:l,line:{color:\"#cc6600\"}}];Plotly.newPlot(\"realTimeProGraph\",H,{xaxis:{title:\"Time\",tickformat:\"%H:%M:%S\",linecolor:\"lightgray\",linewidth:.5,titlefont:{color:\"black\"}},yaxis:{title:\"Energy [kWh] per Block\",tickformat:\"none\",linecolor:\"lightgray\",linewidth:.5,titlefont:{color:\"black\"}},margin:{l:80,r:30,b:50,t:15,pad:4}})}}),n.consumptionContract.ConsumerRegs({},{fromBlock:0,toBlock:\"latest\"}).get(function(e,t){if(e)console.error(e);else{for(var r=0;r<t.length;r++)c.push([t[r].args.pvAddr,t[r].args.owner,t[r].args.deviceType,t[r].args.peakPowerPos,t[r].args.peakPowerNeg,t[r].args.latitude/1e4+\" \"+t[r].args.longitude/1e4,t[r].args.voltageLevel,t[r].args.location,t[r].args.installDate]);var n=document.createElement(\"Table\");n.style.cssText=\"table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;\";var o=c[0].length,a=n.insertRow(-1);for(r=0;r<o;r++){var i=document.createElement(\"TH\");i.innerHTML=c[0][r],a.appendChild(i)}for(r=1;r<c.length;r++){a=n.insertRow(-1);for(var s=0;s<o;s++){var l=a.insertCell(-1);l.style.cssText=\"white-space: nowrap; text-overflow:ellipsis; overflow: hidden; max-width:1px;\",l.innerHTML=c[r][s]}}var d=document.getElementById(\"consRegs\");d.innerHTML=\"\",d.appendChild(n);var u=L.icon({iconUrl:\"../../img/consumer.png\",iconSize:[50,50]}),p=[],g=[],h=[];for(r=0;r<t.length;r++)g.push(t[r].args.latitude/1e4),h.push(t[r].args.longitude/1e4),p.push(t[r].args.latitude/1e4+\", \"+t[r].args.longitude/1e4);for(r=0;r<g.length;r++){var f=h[r],v=g[r],w=\"Eth address: \"+t[r].args.pvAddr.slice(0,7)+\"...<br>Consumer: \"+t[r].args.owner+\"<br>Location: \"+t[r].args.latitude/1e4+\", \"+t[r].args.longitude/1e4,b=new L.LatLng(v,f);p=new L.Marker(b,{icon:u}),m.addLayer(p),p.bindPopup(w)}}}),n.consumptionContract.getConsAccntsList(function(e,t){if(e)console.log(e);else{t.shift();for(var r=0;r<t.length;r++)$(\"#consAccountList\").prepend(\"<li>\"+t[r]+\"</li>\")}}),n.consumptionContract.countConsumers(function(e,t){e?console.log(e):$(\"#consCounter\").html(\" \"+t)}),void n.consumptionContract.EnerConsumptionEvent({fromBlock:\"latest\",toBlock:\"latest\"}).watch(function(e,t){if(e)console.log(e);else{p.push([t.args.oliAddr,a(t.args.eTime),t.args.enerAmount]);var r=document.createElement(\"Table\");r.style.cssText=\"table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;\";for(var n=p[0].length,o=r.insertRow(-1),i=0;i<n;i++){var c=document.createElement(\"TH\");c.innerHTML=p[0][i],o.appendChild(c)}for(i=1;i<p.length;i++){o=r.insertRow(-1);for(var g=0;g<n;g++){var m=o.insertCell(-1);m.style.cssText=\"white-space: nowrap; text-overflow:ellipsis; overflow: hidden; max-width:1px;\",m.innerHTML=p[i][g]}}var h=document.getElementById(\"realTimeConsumption\");h.innerHTML=\"\",h.appendChild(r),l.push(t.args.enerAmount.c[0]),d.push(s());var f=[],v=[],w={};for(var b in d.forEach((e,t)=>w[e]=l[t]),w)w.hasOwnProperty(b);var y={},L={};y.time=b,L.energy=w[b];var T=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}(y,L);u.push(T);var k={};u.forEach(function(e){k.hasOwnProperty(e.time)?k[e.time]=k[e.time]+e.energy:k[e.time]=e.energy});var P=[];for(var x in k)P.push({time:x,energy:k[x]});for(var b in P)P.hasOwnProperty(b)&&(v.push(P[b].time),f.push(P[b].energy));d=v,(l=f).length>10&&(l=l.slice(-10),d=d.slice(-10))}}))}]);","extractedComments":[]}