!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var a;n.r(t);var r=(a=void 0!==a?new Web3(a.currentProvider):new Web3(new Web3.providers.HttpProvider("http://85.214.224.112:8545"))).eth.contract([{anonymous:!1,inputs:[{indexed:!1,name:"oliAddr",type:"address"},{indexed:!1,name:"txTime",type:"uint256[]"},{indexed:!1,name:"txValue",type:"uint32[]"},{indexed:!1,name:"blockNumber",type:"uint256[]"},{indexed:!1,name:"blockHash",type:"bytes32[]"},{indexed:!1,name:"txGasPrice",type:"uint256[]"}],name:"ProTransactionEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"oliAddr",type:"address"},{indexed:!1,name:"eTime",type:"uint256"},{indexed:!1,name:"enerAmount",type:"uint32"}],name:"EnerProductionEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"pvAddr",type:"address"},{indexed:!1,name:"owner",type:"string"},{indexed:!1,name:"deviceType",type:"string"},{indexed:!1,name:"peakPowerPos",type:"uint32"},{indexed:!1,name:"peakPowerNeg",type:"uint32"},{indexed:!1,name:"latitude",type:"uint32"},{indexed:!1,name:"longitude",type:"uint32"},{indexed:!1,name:"voltageLevel",type:"uint32"},{indexed:!1,name:"location",type:"string"},{indexed:!1,name:"installDate",type:"string"}],name:"ProducerRegs",type:"event"},{constant:!1,inputs:[{name:"_enerValue",type:"uint32"}],name:"setEnerProduction",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_owner",type:"string"},{name:"_deviceType",type:"string"},{name:"_peakPowerPos",type:"uint32"},{name:"_peakPowerNeg",type:"uint32"},{name:"_latitude",type:"uint32"},{name:"_longitude",type:"uint32"},{name:"_voltageLevel",type:"uint32"},{name:"_location",type:"string"},{name:"_installDate",type:"string"}],name:"setProducer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{constant:!0,inputs:[],name:"countProducers",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getEnerProduction",outputs:[{name:"",type:"address"},{name:"",type:"uint256"},{name:"",type:"uint32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_proAccntAddr",type:"address"}],name:"getProAccntDetails",outputs:[{name:"",type:"string"},{name:"",type:"string"},{name:"",type:"uint32"},{name:"",type:"string"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getProAccntsList",outputs:[{name:"",type:"address[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_proAccntAddr",type:"address"}],name:"getProBalance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getProducer",outputs:[{name:"",type:"address"},{name:"",type:"string"},{name:"",type:"string"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"string"},{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_proAccntAddr",type:"address"}],name:"getProEnerProduction",outputs:[{name:"",type:"address"},{name:"",type:"uint256[]"},{name:"",type:"uint32[]"},{name:"",type:"uint256[]"},{name:"",type:"bytes32[]"},{name:"",type:"uint256[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"proAccntList",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"producerAddr",type:"address"}],name:"proAccntsArr",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"}]).at("0x839d50761365b8f61e0d32003ae6ee8d9e35df4a"),o=a.eth.contract([{anonymous:!1,inputs:[{indexed:!1,name:"oliAddr",type:"address"},{indexed:!1,name:"txTime",type:"uint256[]"},{indexed:!1,name:"txValue",type:"uint32[]"},{indexed:!1,name:"blockNumber",type:"uint256[]"},{indexed:!1,name:"blockHash",type:"bytes32[]"},{indexed:!1,name:"txGasPrice",type:"uint256[]"}],name:"ConsTransactionEvent",type:"event"},{constant:!1,inputs:[{name:"_owner",type:"string"},{name:"_deviceType",type:"string"},{name:"_peakPowerPos",type:"uint32"},{name:"_peakPowerNeg",type:"uint32"},{name:"_latitude",type:"uint32"},{name:"_longitude",type:"uint32"},{name:"_voltageLevel",type:"uint32"},{name:"_location",type:"string"},{name:"_installDate",type:"string"}],name:"setConsumer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,name:"oliAddr",type:"address"},{indexed:!1,name:"eTime",type:"uint256"},{indexed:!1,name:"enerAmount",type:"uint32"}],name:"EnerConsumptionEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"pvAddr",type:"address"},{indexed:!1,name:"owner",type:"string"},{indexed:!1,name:"deviceType",type:"string"},{indexed:!1,name:"peakPowerPos",type:"uint32"},{indexed:!1,name:"peakPowerNeg",type:"uint32"},{indexed:!1,name:"latitude",type:"uint32"},{indexed:!1,name:"longitude",type:"uint32"},{indexed:!1,name:"voltageLevel",type:"uint32"},{indexed:!1,name:"location",type:"string"},{indexed:!1,name:"installDate",type:"string"}],name:"ConsumerRegs",type:"event"},{constant:!1,inputs:[{name:"_enerValue",type:"uint32"}],name:"setEnerConsumption",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"consAccntList",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"consumerAddr",type:"address"}],name:"consAccntsArr",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"countConsumers",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_consAccntAddr",type:"address"}],name:"getConsAccntDetails",outputs:[{name:"",type:"string"},{name:"",type:"string"},{name:"",type:"uint32"},{name:"",type:"string"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getConsAccntsList",outputs:[{name:"",type:"address[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_consAccntAddr",type:"address"}],name:"getConsBalance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_consAccntAddr",type:"address"}],name:"getConsEnerConsumption",outputs:[{name:"",type:"address"},{name:"",type:"uint256[]"},{name:"",type:"uint32[]"},{name:"",type:"uint256[]"},{name:"",type:"bytes32[]"},{name:"",type:"uint256[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getConsumer",outputs:[{name:"",type:"address"},{name:"",type:"string"},{name:"",type:"string"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"uint32"},{name:"",type:"string"},{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getEnerConsumption",outputs:[{name:"",type:"address"},{name:"",type:"uint256"},{name:"",type:"uint32"}],payable:!1,stateMutability:"view",type:"function"}]).at("0x2d4675d51c9189e51077db494f3b938f47b407e3"),i=a;function s(e){var t=new Date(1e3*e),n=t.getFullYear(),a=("0"+t.getMonth()).slice(-2);return("0"+t.getDate()).slice(-2)+"-"+a+"-"+n+" "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)}function p(){var e=i.eth.getBlock("latest"),t=new Date(1e3*e.timestamp),n=t.getFullYear(),a=t.getUTCMonth()+1,r=("0"+t.getUTCDate()).slice(-2),o=t.getHours(),s="0"+t.getMinutes(),p="0"+t.getSeconds();return n+"-"+a+"-"+r+" "+o+":"+s.substr(-2)+":"+p.substr(-2)}var l=L.icon({iconUrl:"../img/home.png",iconSize:[30,40]}),c=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> Contributors',maxZoom:10}),u={"<span style='color: gray'>Open Street</span>":c,Grayscale:L.tileLayer("http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png",{maxZoom:18,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),"Open Street DE":L.tileLayer("https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png",{maxZoom:18,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),"Open Topo":L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{maxZoom:17,attribution:'Map data: &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}),"ESRI Imagery":L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),"CartoDB Dark":L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',subdomains:"abcd",maxZoom:19})},d=L.map("map",{center:[48.77538056,9.35277778],zoom:14,layers:c});L.control.layers(u).addTo(d);var m=L.marker([48.77538056,9.16277778],{icon:l}).addTo(d);m.bindPopup("OLI Systems GmbH"),m.on("mouseover",function(e){this.openPopup()}),m.on("mouseout",function(e){this.closePopup()});var y=d;var g=[];g.push(["Eth Address","Owner","Device Type","Peak Power (-) [W]","Coordinates [Lat-Long]","Voltage Level [V]","Location","Install Date"]),$("#consRegInfoButton").click(function(){o.consAccntsArr($("#inputConsAddr").val(),function(e,t){e?console.log(e):$("#consRegInfo").html(" "+t)})}),$("#resetConsButton").click(function(){document.getElementById("inputConsAddr").value="",$("#consRegInfo").html("")}),document.getElementById("consAccountList").addEventListener("click",function(e){if("LI"==e.target.nodeName){o.ConsumerRegs({},{fromBlock:0,toBlock:"latest"}).get(function(t,n){if(t)console.error(t);else{for(var a=[],r=[],o={},i=[],s=[],p=0;p<n.length;p++)r.push(n[p].args.latitude/1e4+", "+n[p].args.longitude/1e4),a.push(n[p].args.pvAddr);a.forEach((e,t)=>o[e]=r[t]);for(var p=0;p<Object.keys(o).length;p++)i.push(Object.entries(o)[p]);for(var p=0;p<i.length;p++)if(e.target.innerHTML==i[p][0]){var l=(s=(s=o[e.target.innerHTML]).split(","))[0].trim(),c=s[1].trim(),u=L.icon({iconUrl:"../img/consumer.png",iconSize:[30,40]}),d="Eth address: "+n[p].args.pvAddr.slice(0,7)+"...<br>Consumer: "+n[p].args.owner+"<br>Location: "+n[p].args.latitude/1e4+", "+n[p].args.longitude/1e4;void 0!=h&&y.removeLayer(h),(h=L.marker([l,c],{icon:u}).addTo(y)).bindPopup(d,{maxWidth:"500",className:"currentCons-popup"}).openPopup()}}}),document.getElementById("consAccntTitle").innerHTML=e.target.innerHTML,o.getConsAccntDetails(e.target.innerHTML,function(e,t){e?console.log(e):($("#consOwner").html(t[0]),$("#consDeviceType").html(t[1]),document.getElementById("consPeakPower").innerHTML=t[2],$("#consLocationType").html(t[3]),$("#consLat").html(t[4]/1e4),$("#consLon").html(t[5]/1e4),$("#consInstallDate").html(t[6]))}),o.getConsBalance(e.target.innerHTML,function(e,t){e?console.log(e):document.getElementById("consAccntBalance").innerHTML=t}),o.getConsEnerConsumption(e.target.innerHTML,function(e,t){if(e)console.error(e);else{var n=document.getElementById("consAccount");n.innerHTML="";var a=[];a.push(["Eth Address","Time","Power [W]","Block Number","BlockHash","Gas Price [wei]"]);for(var r=0;r<t[1].length;r++)a.push([t[0],s(t[1][r].c),t[2][r].c,t[3][r].c,t[4][r],t[5][r].c]);var n=document.getElementById("consAccount");n.style.cssText="table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;";for(var o=a[0].length,i=n.insertRow(-1),r=0;r<o;r++){var p=document.createElement("TH");p.innerHTML=a[0][r],i.appendChild(p)}for(var r=1;r<a.length;r++){i=n.insertRow(-1);for(var l=0;l<o;l++){var c=i.insertCell(-1);c.innerHTML=a[r][l]}}}});for(var t=0;t<e.target.parentNode.children.length;t++)e.target.parentNode.children[t].classList.remove("activeConsumer");e.target.classList.add("activeConsumer")}});var h={};var v=[],f=[],b=[],w=[];w.push(["Eth Address","Time","Power [W]"]);var T=[];T.push(["Eth Address","Owner","Device Type","Peak Power (+) [W]","Coordinates [Lat-Long]","Voltage Level [V]","Location","Install Date"]),$("#proRegInfoButton").click(function(){r.proAccntsArr($("#inputProAddr").val(),function(e,t){e?console.log(e):$("#proRegInfo").html(" "+t)})}),$("#resetProButton").click(function(){document.getElementById("inputProAddr").value="",$("#proRegInfo").html("")});var P=[],x=[],k=[],M=[];M.push(["Eth Address","Time","Power [W]"]),document.getElementById("proAccountList").addEventListener("click",function(e){if("LI"==e.target.nodeName){r.ProducerRegs({},{fromBlock:0,toBlock:"latest"}).get(function(t,n){if(t)console.error(t);else{for(var a=[],r=[],o={},i=[],s=[],p=0;p<n.length;p++)r.push(n[p].args.latitude/1e4+", "+n[p].args.longitude/1e4),a.push(n[p].args.pvAddr);a.forEach((e,t)=>o[e]=r[t]);for(var p=0;p<Object.keys(o).length;p++)i.push(Object.entries(o)[p]);for(var p=0;p<i.length;p++)if(e.target.innerHTML==i[p][0]){var l=(s=(s=o[e.target.innerHTML]).split(","))[0].trim(),c=s[1].trim(),u=L.icon({iconUrl:"../img/producer.png",iconSize:[30,40]}),d="Eth address: "+n[p].args.pvAddr.slice(0,7)+"...<br>Producer: "+n[p].args.owner+"<br>Location: "+n[p].args.latitude/1e4+", "+n[p].args.longitude/1e4;void 0!=A&&y.removeLayer(A),(A=L.marker([l,c],{icon:u}).addTo(y)).bindPopup(d,{maxWidth:"500",className:"currentPro-popup"}).openPopup()}}}),document.getElementById("proAccntTitle").innerHTML=e.target.innerHTML,r.getProAccntDetails(e.target.innerHTML,function(e,t){e?console.log(e):($("#proOwner").html(t[0]),$("#proDeviceType").html(t[1]),document.getElementById("proPeakPower").innerHTML=t[2],$("#proLocationType").html(t[3]),$("#proLat").html(t[4]/1e4),$("#proLon").html(t[5]/1e4),$("#proInstallDate").html(t[6]))}),r.getProBalance(e.target.innerHTML,function(e,t){e?console.log(e):document.getElementById("proAccntBalance").innerHTML=t}),r.getProEnerProduction(e.target.innerHTML,function(e,t){if(e)console.error(e);else{var n=document.getElementById("proAccount");n.innerHTML="";var a=[];a.push(["Eth Address","Time","Power [W]","Block Number","BlockHash","Gas Price [wei]"]);for(var r=0;r<t[1].length;r++)a.push([t[0],s(t[1][r].c),t[2][r].c,t[3][r].c,t[4][r],t[5][r].c]);var o=document.getElementById("proAccount");o.style.cssText="table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;";for(var i=a[0].length,p=o.insertRow(-1),r=0;r<i;r++){var l=document.createElement("TH");l.innerHTML=a[0][r],p.appendChild(l)}for(var r=1;r<a.length;r++){p=o.insertRow(-1);for(var c=0;c<i;c++){var u=p.insertCell(-1);u.innerHTML=a[r][c]}}}});for(var t=0;t<e.target.parentNode.children.length;t++)e.target.parentNode.children[t].classList.remove("active");e.target.classList.add("active")}});var A={};setInterval(function(){var e=i.eth.blockNumber,t=i.eth.getBlockTransactionCount("latest"),n=i.eth.getBlock("latest").gasUsed/1e6;n=n.toFixed(2),document.getElementById("blockNumber").innerHTML=e,document.getElementById("txMined").innerHTML=t,document.getElementById("gasUsed").innerHTML=n},3e3),window.onload=(r.ProducerRegs({},{fromBlock:0,toBlock:"latest"}).get(function(e,t){if(e)console.error(e);else{for(var n=0;n<t.length;n++)T.push([t[n].args.pvAddr,t[n].args.owner,t[n].args.deviceType,t[n].args.peakPowerPos,t[n].args.latitude/1e4+" "+t[n].args.longitude/1e4,t[n].args.voltageLevel,t[n].args.location,t[n].args.installDate]);var a=document.createElement("Table");a.style.cssText="table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;";var r=T[0].length,o=a.insertRow(-1);for(n=0;n<r;n++){var i=document.createElement("TH");i.innerHTML=T[0][n],o.appendChild(i)}for(n=1;n<T.length;n++){o=a.insertRow(-1);for(var s=0;s<r;s++)o.insertCell(-1).innerHTML=T[n][s]}var p=document.getElementById("proRegs");p.innerHTML="",p.appendChild(a);var l=L.icon({iconUrl:"../img/producer.png",iconSize:[50,50]}),c=[],u=[],d=[];for(n=0;n<t.length;n++)u.push(t[n].args.latitude/1e4),d.push(t[n].args.longitude/1e4),c.push(t[n].args.latitude/1e4+", "+t[n].args.longitude/1e4);for(n=0;n<u.length;n++){var m=d[n],g=u[n],h="Eth address: "+t[n].args.pvAddr.slice(0,7)+"...<br>Producer: "+t[n].args.owner+"<br>Location: "+t[n].args.latitude/1e4+", "+t[n].args.longitude/1e4,v=new L.LatLng(g,m);c=new L.Marker(v,{icon:l}),y.addLayer(c),c.bindPopup(h)}}}),r.ProducerRegs({fromBlock:"latest",toBlock:"latest"}).watch(function(e,t){e&&console.log(e)}),r.getProAccntsList(function(e,t){if(e)console.log(e);else{t.shift();for(var n=0;n<t.length;n++)$("#proAccountList").prepend("<li>"+t[n]+"</li>")}}),r.countProducers(function(e,t){e?console.log(e):$("#proCounter").html(" "+t)}),r.EnerProductionEvent({fromBlock:"latest",toBlock:"latest"}).watch(function(e,t){if(e)console.log(e);else{M.push([t.args.oliAddr,s(t.args.eTime),t.args.enerAmount]);var n=document.createElement("Table");n.style.cssText="table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;";for(var a=M[0].length,r=n.insertRow(-1),o=0;o<a;o++){var i=document.createElement("TH");i.innerHTML=M[0][o],r.appendChild(i)}for(o=1;o<M.length;o++){r=n.insertRow(-1);for(var l=0;l<a;l++)r.insertCell(-1).innerHTML=M[o][l]}var c=document.getElementById("realTimeProdunction");c.innerHTML="",c.appendChild(n),P.push(t.args.enerAmount.c[0]),x.push(p());var u=[],d=[],m={};for(var y in x.forEach((e,t)=>m[e]=P[t]),m)m.hasOwnProperty(y);var g={},h={};g.time=y,h.energy=m[y];var b=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(g,h);k.push(b);var w={};k.forEach(function(e){w.hasOwnProperty(e.time)?w[e.time]=w[e.time]+e.energy:w[e.time]=e.energy});var L=[];for(var T in w)L.push({time:T,energy:w[T]});for(var y in L)L.hasOwnProperty(y)&&(d.push(L[y].time),u.push(L[y].energy));function A(e){return new Date(e)}x=d,(P=u).length>10&&(P=P.slice(-10),x=x.slice(-10));var E=[{type:"date",mode:"lines+markers",name:"Producer",x:x.map(A),y:P,line:{color:"#009933"}},{type:"scatter",mode:"lines+markers",name:"Consumer",x:f.map(A),y:v,line:{color:"#cc6600"}}];Plotly.newPlot("realTimeProGraph",E,{xaxis:{title:"Time",tickformat:"%H:%M:%S",linecolor:"lightgray",linewidth:.5,titlefont:{color:"black"}},yaxis:{title:"Energy [kWh] per Block",tickformat:"none",linecolor:"lightgray",linewidth:.5,titlefont:{color:"black"}},margin:{l:80,r:30,b:50,t:15,pad:4}})}}),o.ConsumerRegs({},{fromBlock:0,toBlock:"latest"}).get(function(e,t){if(e)console.error(e);else{for(var n=0;n<t.length;n++)g.push([t[n].args.pvAddr,t[n].args.owner,t[n].args.deviceType,t[n].args.peakPowerNeg,t[n].args.latitude/1e4+" "+t[n].args.longitude/1e4,t[n].args.voltageLevel,t[n].args.location,t[n].args.installDate]);var a=document.createElement("Table");a.style.cssText="table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;";var r=g[0].length,o=a.insertRow(-1);for(n=0;n<r;n++){var i=document.createElement("TH");i.innerHTML=g[0][n],o.appendChild(i)}for(n=1;n<g.length;n++){o=a.insertRow(-1);for(var s=0;s<r;s++)o.insertCell(-1).innerHTML=g[n][s]}var p=document.getElementById("consRegs");p.innerHTML="",p.appendChild(a);var l=L.icon({iconUrl:"../img/consumer.png",iconSize:[50,50]}),c=[],u=[],d=[];for(n=0;n<t.length;n++)u.push(t[n].args.latitude/1e4),d.push(t[n].args.longitude/1e4),c.push(t[n].args.latitude/1e4+", "+t[n].args.longitude/1e4);for(n=0;n<u.length;n++){var m=d[n],h=u[n],v="Eth address: "+t[n].args.pvAddr.slice(0,7)+"...<br>Consumer: "+t[n].args.owner+"<br>Location: "+t[n].args.latitude/1e4+", "+t[n].args.longitude/1e4,f=new L.LatLng(h,m);c=new L.Marker(f,{icon:l}),y.addLayer(c),c.bindPopup(v)}}}),o.getConsAccntsList(function(e,t){if(e)console.log(e);else{t.shift();for(var n=0;n<t.length;n++)$("#consAccountList").prepend("<li>"+t[n]+"</li>")}}),o.countConsumers(function(e,t){e?console.log(e):$("#consCounter").html(" "+t)}),void o.EnerConsumptionEvent({fromBlock:"latest",toBlock:"latest"}).watch(function(e,t){if(e)console.log(e);else{w.push([t.args.oliAddr,s(t.args.eTime),t.args.enerAmount]);var n=document.createElement("Table");n.style.cssText="table-layout: fixed;  width: 100%; font-size: 12px; word-break: break-word:display: block;";for(var a=w[0].length,r=n.insertRow(-1),o=0;o<a;o++){var i=document.createElement("TH");i.innerHTML=w[0][o],r.appendChild(i)}for(o=1;o<w.length;o++){r=n.insertRow(-1);for(var l=0;l<a;l++)r.insertCell(-1).innerHTML=w[o][l]}var c=document.getElementById("realTimeConsumption");c.innerHTML="",c.appendChild(n),v.push(t.args.enerAmount.c[0]),f.push(p());var u=[],d=[],m={};for(var y in f.forEach((e,t)=>m[e]=v[t]),m)m.hasOwnProperty(y);var g={},h={};g.time=y,h.energy=m[y];var L=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(g,h);b.push(L);var T={};b.forEach(function(e){T.hasOwnProperty(e.time)?T[e.time]=T[e.time]+e.energy:T[e.time]=e.energy});var P=[];for(var x in T)P.push({time:x,energy:T[x]});for(var y in P)P.hasOwnProperty(y)&&(d.push(P[y].time),u.push(P[y].energy));f=d,(v=u).length>10&&(v=v.slice(-10),f=f.slice(-10))}}))}]);
//# sourceMappingURL=app.js.map